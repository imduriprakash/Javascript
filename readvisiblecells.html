<html>
<body>
<table>
	<h1> Get human readble string by skipping masked cells.</h1>
    <tbody>
    <tr>
        <td style="color: #ff00ff; background-color:#FFFFFF">Q</TD>
        <td style="background-color: #442244; color: #442244">Y</td>
        <td style="color: #FFFF00; background-color:#442244">A</td>
    </tr>
    <tr>
        <td style="color: #FFEEFE; background-color:#990000">Q</td>
        <td style="color: #FFFF00; background-color:#FF0">M</td>
        <td style="color: #000000; background-color:#FF7777">O</td>
    </tr>
    </tbody>
</table>
<button onclick="myFunction()">Try it</button>
<script>

function rgb2hex(rgb) {
     if (  rgb.search("rgb") == -1 ) {
          return rgb;
     } else {
          rgb = rgb.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+))?\)$/);
          function hex(x) {
               return ("0" + parseInt(x).toString(16)).slice(-2);
          }
          return "#" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3]); 
     }
}
function myFunction() {
    var str ='';
    var table = document.getElementsByTagName("table");
    var rc = table[0].rows.length;
    for (var i = 0; i < rc; i++) {
    row = table[0].rows[i];
    var cc = row.cells.length;
	    for (var j = 0; j < cc; j++) {
	        col = row.cells[j];
	        bgcol = col.style.backgroundColor;
	        bghex = rgb2hex(bgcol);
	        //console.log(bghex);
	        cellcolor = col.style.color;
	        cellhex = rgb2hex(cellcolor);
	        console.log(cellhex);
	        if(bghex != cellhex)
	        {
	            str = str + col.innerHTML;
	        }
	    }  
	}
	alert(str);
}
</script>
</body>
</html>